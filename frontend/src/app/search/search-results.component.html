<ng-container *ngIf="results===undefined || !results.total; else resultsBlock">
    <h2 class="subtitle">
        0 hits
    </h2>
</ng-container>
<ng-template #resultsBlock>
    <h2 class="subtitle" *ngIf="results.total <= 5">
        {results.total, plural, =1 {1 hit} other {{{results.total}} hits}}
    </h2>
    <h2 class="subtitle" *ngIf="results.total > 5">
        {{results.total}} results.
        Showing results {{fromIndex+1}} - {{fromIndex+resultsPerPage > totalResults? totalResults : fromIndex+resultsPerPage}}:
    </h2>
    <section class="section results-navigation" #resultsNavigation [ngClass]="{'is-scrolled-down': isScrolledDown}">
    <div class="level">
    <div class="level-left has-text-centered">
        <div>
            <p class="heading">Sort By</p>
            <ng-content></ng-content>
        </div>
    </div>
    <div class="level-right has-text-centered" *ngIf="results.total > resultsPerPage" >
        <div>
            <p class="heading">Pages</p>
            <ia-pagination [totalResults]="totalResults" (loadResults)=loadResults($event)></ia-pagination>
        </div>
        </div>
    </div>
    </section>
    <div class="hits" [ngClass]="{'is-loading':isLoading}">
        <div *ngFor="let document of results.documents" class="document box" role="button">
            <div class="columns">
                <div class="column is-flex" (click)=onViewDocument(document)>  
                    <table class="table is-fullwidth">
                        <ng-container *ngFor="let field of results.fields">
                            <tr *ngIf="document.fieldValues[field.name]">
                                <td>
                                    <b>{{field.displayName}}: </b>
                                </td>
                                <td style="word-break:break-word" [innerHtml]="document.fieldValues[field.name] | highlight:query:true"></td>
                            </tr>
                        </ng-container>
                    </table>
                </div>  
                <div class="column is-one-quarter" *ngIf="document.relevance">
                    <div class="relevance-score">
                        <span>Relevance: {{document.relevance * 100 | number:'1.0-0' }}%</span>
                    </div>
                    <search-relevance [value]="document.relevance"></search-relevance>
                    <span *ngIf="corpus.scan_image_type" class="scan-button" iaBalloon="View Scan" (click)="goToScan(document, $event)">
                        <i class="fa fa-newspaper-o fa-4x" aria-hidden="true"></i>
                    </span>
                </div>
            </div>
        </div>
    </div>
</ng-template>

<!-- show the selected document -->
<p-dialog header="Document {{viewDocument.position}} of {{totalResults}}" [(visible)]="showDocument" width="100%"
    [modal]="true" [responsive]="true" [maximizable]="true" [dismissableMask]="true" [draggable]="false" [resizable]="false" [blockScroll]="true"
    *ngIf="viewDocument">
    <ia-document-view [document]="viewDocument" [fields]="corpus.fields" [query]="queryText" [corpus]="corpus" [tabIndex]="documentTabIndex"></ia-document-view>
</p-dialog>

<!-- inform the user about a failed search -->
<p-dialog [(visible)]="showError" width="600" *ngIf="showError">
    <p-header>Unfortunately, we couldn&rsquo;t complete your request</p-header>
    <div class="content">
        <p>Please try again later, or seek support if the problem persists. In order to help us help you, please provide the
            following information when seeking support:</p>
        <table>
            <tbody>
                <tr>
                    <th>Date</th>
                    <td>
                        <code>{{showError.date}}</code>
                    </td>
                </tr>
                <tr>
                    <th>URL</th>
                    <td>
                        <code>{{showError.href}}</code>
                    </td>
                </tr>
                <tr>
                    <th>Error</th>
                    <td>
                        <code>{{showError.message}}</code>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
</p-dialog>
