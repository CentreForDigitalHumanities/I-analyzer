<ng-container *ngIf="results===undefined || !results.total; else resultsBlock">
    <h2 class="subtitle">
        0 hits
    </h2>
</ng-container>
<ng-template #resultsBlock>
    <h2 class="subtitle" *ngIf="results.total <= 5">
        {results.total.value, plural, =1 {1 hit} other {{{results.total.value}} hits}}
    </h2>
    <h2 class="subtitle" *ngIf="results.total.value > 5">
        {{results.total.value}} results.
        Showing results {{fromIndex+1}} -
        {{fromIndex+resultsPerPage > totalResults? totalResults : fromIndex+resultsPerPage}}:
    </h2>
    <section class="section results-navigation" #resultsNavigation [ngClass]="{'is-scrolled-down': isScrolledDown}">
        <div class="level">
            <div class="level-left has-text-centered">
                <div>
                    <p class="heading">Sort By</p>
                    <ng-content></ng-content>
                </div>
            </div>
            <div class="level-right has-text-centered" *ngIf="results.total.value > resultsPerPage">
                <div>
                    <p class="heading">Pages</p>
                    <ia-pagination [totalResults]="totalResults" (loadResults)=loadResults($event)></ia-pagination>
                </div>
            </div>
        </div>
    </section>
    <div class="hits" [ngClass]="{'is-loading':isLoading}">
        <div *ngFor="let document of results.documents; last as isLast" class="document box" #resultdoc role="button">
            <div class="columns">
                <div class="column is-flex" (click)="onViewDocument(document, isLast, $event)">
                    <table class="table is-fullwidth">
                        <ng-container *ngFor="let field of results.fields">
                            <tr *ngIf="document.fieldValues[field.name]">
                                <td>
                                    <b>{{field.displayName}}: </b>
                                </td>
                                <td style="word-break:break-word"
                                    [innerHtml]="document.fieldValues[field.name] | highlight:query:true"></td>
                            </tr>
                        </ng-container>
                    </table>
                </div>
                <div class="column is-one-quarter">
                    <button *ngIf="document.fieldValues['image_path']" class="button scan-button is-primary is-inverted"
                        iaBalloon="View Photograph" (click)="goToScan(document, $event)">
                        <span class="icon">
                            <i class="fa fa-image-o fa-3x" aria-hidden="true"></i>
                        </span>
                    </button>
                </div>
            </div>
        </div>
    </div>
</ng-template>

<!-- show the selected document -->
<p-dialog header="Document {{viewDocument.position}} of {{totalResults}}" [(visible)]="showDocument" width="100%"
    [modal]="true" [responsive]="true" [maximizable]="true" [dismissableMask]="true" [draggable]="true"
    [resizable]="false" [blockScroll]="true" *ngIf="viewDocument" [positionTop]="detailTop">
    <ia-document-view [document]="viewDocument" [fields]="corpus.fields" [query]="queryText" [corpus]="corpus"
        [documentTabIndex]="documentTabIndex"></ia-document-view>
</p-dialog>

<ia-error *ngIf="showError" [showError]="showError"></ia-error>
