<div *ngIf="noVisualizations">
    <b> This corpus has no fields with associated visualizations. </b>
</div>

<div class="level" *ngIf="!noVisualizations" #viscontrol>
    <div class="level-left">
        <div class="level-item">
            <ia-dropdown [options]="visDropdown" optionLabel="label" [value]="visDropdown[0]" (onChange)="setVisualizedField($event.value)"></ia-dropdown>
        </div>
    </div>
    <div class="level-right">
        <div class="level-item" *ngIf="!freqtable">
            <ia-dropdown [options]="palettes" [value]="palettes[0]" optionLabel="label" (onChange)="palette = $event.palette"></ia-dropdown>
        </div>
        <div class="level-item">
            <!-- Buttons for switching between table and graphical representation -->
            <button [class.button]="true" [class.is-primary]="freqtable" (click)="freqtable = true" style="float:right">
                <i class="fa fa-table" aria-hidden="true"></i>
            </button>

            <button [class.button]="true" [class.is-primary]="!freqtable" (click)="freqtable = false" style="float:right">
                <i class="fa fa-bar-chart" aria-hidden="true"></i>
            </button>
        </div>
    </div>
</div>


<ng-container *ngIf="visualExists; else noVisualsMessage">
    <div  [ngClass]="{'is-loading':isLoading}">
        <ng-container [ngSwitch]="visualizedField.visualization">
            <ia-histogram *ngSwitchCase="'histogram'" [corpus]="corpus" [queryModel]="queryModel" [visualizedField]="visualizedField"
                [documentLimit]="histogramDocumentLimit" [asTable]="freqtable" [palette]="palette"
                (isLoading)="onIsLoading($event)" (error)="setErrorMessage($event)" (totalTokenCountAvailable)="showTokenCountOption = $event">
    		</ia-histogram>
    		<ia-timeline *ngSwitchCase=" 'timeline' " [corpus]="corpus" [queryModel]="queryModel" [visualizedField]="visualizedField"
    		    [documentLimit]="histogramDocumentLimit" [asTable]="freqtable" [palette]="palette"
                (isLoading)="onIsLoading($event)" (totalTokenCountAvailable)="showTokenCountOption = $event"></ia-timeline>
            <ia-wordcloud *ngSwitchCase=" 'wordcloud' " [corpus]="corpus" [queryModel]="queryModel" [visualizedField]="visualizedField"
                [resultsCount]="resultsCount" [asTable]="freqtable" [palette]="palette"
                (isLoading)="onIsLoading($event)" (error)="setErrorMessage($event['message'])"></ia-wordcloud>
            <ia-related-words  *ngSwitchCase=" 'relatedwords' " [corpus]="corpus" [queryModel]="queryModel"
                [asTable]="freqtable" [palette]="palette" (isLoading)="onIsLoading($event)" (error)="setErrorMessage($event)"></ia-related-words>
            <ia-ngram *ngSwitchCase=" 'ngram' " [corpus]="corpus" [queryModel]="queryModel" [visualizedField]="visualizedField"
                [asTable]="freqtable" [palette]="palette"
                (isLoading)="onIsLoading($event)"></ia-ngram>
        </ng-container>
    </div>
</ng-container>

<ng-template #noVisualsMessage>
    <b> {{foundNoVisualsMessage}} </b>
    <div class="container" *ngIf="errorMessage && errorMessage.length > 0">
        <div class="notification is-warning">
            {{errorMessage}}
        </div>
    </div>
</ng-template>
