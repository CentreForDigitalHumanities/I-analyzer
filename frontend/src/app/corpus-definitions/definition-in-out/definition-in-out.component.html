<section class="section">
    <div class="container">
        <nav aria-label="secondary navigation" class="breadcrumb">
            <ul>
                <li><a [routerLink]="['/']">Corpora</a></li>
                <li><a [routerLink]="['../..']">Definitions</a></li>
                <li class="is-active" aria-current="page"><a>{{corpus.definition?.meta.title ||
                        '...'}}: import/export</a></li>
            </ul>
        </nav>

        <h1 class="title">Import/export corpus "{{corpus.definition?.meta.title || '...'}}"</h1>

        <h2 class="title is-4">Export</h2>

        <p class="block">
            You can download the definition of this corpus as a JSON file. This file
            describes how you have configured this corpus: the name, description,
            fields, et cetera. It does not contain any source files you uploaded.
        </p>

        <div class="block">
            <button class="button" (click)="downloadJSON()">
                <span class="icon" aria-hidden="true">
                    <fa-icon [icon]="actionIcons.download"></fa-icon>
                </span>
                <span>Download JSON</span>
            </button>
        </div>

        <h2 class="title is-4">Import</h2>

        <p class="block">
            You can upload a JSON definition file for this corpus. This will configure
            the corpus according to the specifications in the file.
        </p>

        <p class="block">
            JSON uploads are only accepted if they follow the format used by I-analyzer.
            If you download a corpus definition from I-analyzer and then upload it (for
            example, to restore an earlier backup), this is always the case.
        </p>

        <p class="block">
            <i>Advanced usage:</i>
            If you want to write or edit the JSON file for a corpus directly, you can
            consult the
            <a href="/api/corpus/definition-schema">specification</a>.
            This is encoded as a
            as a <a href="https://json-schema.org/">JSON schema</a>.
        </p>

        <form>
            <div class="block">
                <ia-definition-json-upload [reset]="reset$" (upload)="onJSONUpload($event)">
                </ia-definition-json-upload>
            </div>

            <div class="block">
                <button class="button is-primary" [class.is-loading]="corpus.loading$ | async" type="submit"
                    (click)="submit()">
                    <span class="icon" aria-hidden="true">
                        <fa-icon [icon]="formIcons.confirm"></fa-icon>
                    </span>
                    <span>
                        Save changes
                    </span>
                </button>
                &nbsp;
                <button class="button" type="reset" (click)="reset()">
                    <span class="icon" aria-hidden="true">
                        <fa-icon [icon]="formIcons.reset"></fa-icon>
                    </span>
                    <span>
                        Cancel changes
                    </span>
                </button>
            </div>

            <div class="message is-danger" *ngIf="error">
                <div class="message-body">
                    Could not save corpus: {{error.message}}
                </div>
            </div>
        </form>
    </div>
</section>
